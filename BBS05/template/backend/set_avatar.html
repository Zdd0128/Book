{% extends 'backend/backend.html' %}

{% block article %}
    <h3 class="text-center">修改头像</h3>
    <form action="" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="form-group">
            <p><label for="">原头像:</label></p>
            <img height="120" style="border-radius: 50%" src="/app01/media/{{ request.user.avatar }}/" alt="">
        </div>

        <div class="form-group">
            <p><label for="new_avatar">新头像:<img id="old_avatar" height="120"
                                                style=" position: fixed; left: 270px;top: 370px; border-radius: 50%"
                                                src="/static/image/def.jpg" alt=""></label></p>
            <input name="new_avatar" type="file" id="new_avatar" style="display: none">
        </div>
        <div>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
        </div>
        <button class="btn btn-success" style="height: 35px;width: 200px">保存</button>
    </form>

{% endblock %}

{% block js %}
    <script>
        $('#new_avatar').change(function () {
            let fileReaderObj = new FileReader()
            let fileObj = $(this)[0].files[0]
            fileReaderObj.readAsDataURL(fileObj)
            fileReaderObj.onload = function () {
                $('#old_avatar').attr('src', fileReaderObj.result)
            }
        })
    </script>
{% endblock %}